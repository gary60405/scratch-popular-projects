<mat-card class="mat-elevation-z16 p-0">
  <mat-accordion>
    <mat-expansion-panel hideToggle="true" (opened)="togglePanel(true)" (closed)="togglePanel(false)">
      <mat-expansion-panel-header>
        <mat-panel-description>
          <div class="ml-auto mr-auto d-flex align-items-center">
            <span class="font-weight-bold">簡易檢索請開啟</span>
            <mat-icon>keyboard_arrow_down</mat-icon>
          </div>
        </mat-panel-description>
      </mat-expansion-panel-header>
      <mat-form-field class="w-100">
        <input matInput color="accent" (keyup)="applyFilter($event.target.value)" placeholder="搜尋">
      </mat-form-field>
    </mat-expansion-panel>
  </mat-accordion>
  <div class="table-basic" [ngClass]="{'table-height-short': isPanelOpen, 'table-height-long':!isPanelOpen}">
  <table mat-table class="w-100" [dataSource]="dataSource" matSort multiTemplateDataRows>
    <ng-container *ngFor="let column of displayedColumns" matColumnDef="{{column}}">
      <th mat-header-cell *matHeaderCellDef mat-sort-header class="font-weight-bold d-flex w-100"> {{column}} </th>
      <td mat-cell *matCellDef="let element" class="d-flex w-100"> {{element[column]}} </td>
    </ng-container>
    <ng-container matColumnDef="expandedDetail">
      <td mat-cell *matCellDef="let element" [attr.colspan]="displayedColumns.length" class="bg-light">
        <div class="element-detail" [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'">
          <div class="container-fliud w-100">
            <ng-template #spinner>
              <mat-progress-bar color="warn" mode="indeterminate"></mat-progress-bar>
            </ng-template>
            <div *ngIf="isReady;else spinner" class="row" >
              <div class="col-3">
                <img [src]="imageUrl" class="ml-3 p-3" alt="">
              </div>
              <div class="col-9 m-0 d-flex align-items-center">
                <div class="d-flex align-items-center text-size-1_5em ">
                  <div class="font-weight-bold">專案連結：</div><a [href]="projectUrl" target="_blank">點我前往</a>
                </div>
                <div *ngIf="rootUrl !== '本專案為根專案'" class="d-flex align-items-center text-size-1_5em ml-5">
                  <div class="font-weight-bold">改編根專案：</div><a [href]="rootUrl" target="_blank">點我前往</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </td>
    </ng-container>
    <tr class="d-flex sticky-top" mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
    <tr mat-row *matRowDef="let element; columns: displayedColumns;" class="element-row d-flex" [class.expanded-row]="expandedElement === element"
      (click)="getScratchData(element);expandedElement = expandedElement === element ? null : element">
    </tr>
    <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="detail-row"></tr>
  </table>
</div>
  <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]"></mat-paginator>
</mat-card>
<button (click)="openBottomSheet()" class="switch-button bg-danger text-white font-weight-bold" mat-raised-button>切換資料檔</button>

<ng-template #dataSourceSwitcher>
  <mat-list role="list">
    <mat-radio-group (change)="selectDataSource($event.value)">
      <mat-list-item role="listitem">
        <mat-radio-button [checked]="currentDataScource === 'ROOT_DATA'" value="ROOT_DATA">改編數最高的根專案</mat-radio-button>
      </mat-list-item>
      <mat-list-item role="listitem">
        <mat-radio-button [checked]="currentDataScource === 'LIKE_DATA'" value="LIKE_DATA">喜愛數最高的專案</mat-radio-button>
      </mat-list-item>
      <mat-list-item role="listitem">
        <mat-radio-button [checked]="currentDataScource === 'FAVORITE_DATA'" value="FAVORITE_DATA">收藏數最高的專案</mat-radio-button>
      </mat-list-item>
      <mat-list-item role="listitem">
        <mat-radio-button [checked]="currentDataScource === 'VIEW_DATA'" value="VIEW_DATA">觀看數最高的專案</mat-radio-button>
      </mat-list-item>
    </mat-radio-group>
  </mat-list>
</ng-template>
